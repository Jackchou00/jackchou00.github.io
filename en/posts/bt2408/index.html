<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>A Small Experiment to Help Understand HDR Transfer Functions | üè°JacksBlog</title>
<meta name="keywords" content="Colour, HDR, Display">
<meta name="description" content="Some tedious definitions, with love from BT.2408">
<meta name="author" content="Jack">
<link rel="canonical" href="https://jackchou.top/en/posts/bt2408/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e30af01949f15b214a659db89950589c44040efcfcdeec2087ad8629d77c216e.css" integrity="sha256-4wrwGUnxWyFKZZ24mVBYnEQEDvz83uwgh62GKdd8IW4=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://jackchou.top/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jackchou.top/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jackchou.top/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jackchou.top/apple-touch-icon.png">
<link rel="mask-icon" href="https://jackchou.top/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh-cn" href="https://jackchou.top/posts/bt2408/">
<link rel="alternate" hreflang="en" href="https://jackchou.top/en/posts/bt2408/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js" integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Google+Sans+Code:ital,wght@0,300..800;1,300..800&family=Noto+Sans+SC:wght@100..900&family=Sen:wght@400..800&display=swap" rel="stylesheet"><meta property="og:url" content="https://jackchou.top/en/posts/bt2408/">
  <meta property="og:site_name" content="üè°JacksBlog">
  <meta property="og:title" content="A Small Experiment to Help Understand HDR Transfer Functions">
  <meta property="og:description" content="Some tedious definitions, with love from BT.2408">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-26T02:00:00+08:00">
    <meta property="article:modified_time" content="2025-05-26T02:00:00+08:00">
    <meta property="article:tag" content="Colour">
    <meta property="article:tag" content="HDR">
    <meta property="article:tag" content="Display">
      <meta property="og:image" content="https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp">
<meta name="twitter:title" content="A Small Experiment to Help Understand HDR Transfer Functions">
<meta name="twitter:description" content="Some tedious definitions, with love from BT.2408">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts üå≥",
      "item": "https://jackchou.top/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "A Small Experiment to Help Understand HDR Transfer Functions",
      "item": "https://jackchou.top/en/posts/bt2408/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "A Small Experiment to Help Understand HDR Transfer Functions",
  "name": "A Small Experiment to Help Understand HDR Transfer Functions",
  "description": "Some tedious definitions, with love from BT.2408",
  "keywords": [
    "Colour", "HDR", "Display"
  ],
  "articleBody": "I realised I haven‚Äôt written a blog post in a while. I actually have many drafts, but they are all in a state of being unfinished.\nI‚Äôm porting over an issue from GitHub that helps with the correct use and understanding of various HDR transfer functions.\nhttps://github.com/colour-science/colour/issues/1348\nThe gist of the issue is that, following Table 1 of BT.2408, if you place diffuse white at a display luminance of 203.0 nits, the calculated display luminance for an 18% grey card is not 26 nits.\nBT.2408 and the Problem BT.2408 is a standard concerning operational practices for HDR. Table 1 recommends the display luminance and corresponding code values under different transfer functions for several objects.\nReflectance Object or Reference (Luminance Factor, %) Nominal Luminance, cd/m¬≤ (PQ \u0026 1000 cd/m¬≤ HLG) Nominal Signal Level Nominal Signal Level Grey Card (18%) 26 38 38 Greyscale Chart Max (83%) 162 56 71 Greyscale Chart Max (90%) 179 57 73 Reference Level: HDR Reference White (100%) also diffuse white and Graphics White 203 58 75 The question is how to use HDR transfer functions to convert between these numbers, for instance, using Python‚Äôs colour library.\nimport colour Theory The table is divided into three parts. The first column is reflectance, corresponding to scene-referred linear light. The second column is display luminance, which is display-referred linear light. The last two columns are the code values for the two systems.\nTheir numerical ranges are:\nScene Light: 0.0 - 1.0. This is relative and, for example, in a photography system, is controlled by the camera‚Äôs exposure. The scene light for a grey card and diffuse white could be 0.18 and 1.0, or it could be 0.018 and 0.1. Display Light: 0.0 - 10000 nits. This is absolute in an HDR system. For the HLG system, a peak luminance must be specified, for example, 1000 nits. Code Value: 0 - 255 or 0 - 1023, depending on the system‚Äôs bit depth. It can also be represented by floating-point numbers from 0.0 - 1.0. Personally, I find floating-point numbers easier to work with. A transfer function system defines how to perform these conversions between luminance and code values.\nThe conversion from scene linear light to display linear light is called the opto-opto transfer function (OOTF). The conversion from scene linear light to code value is called the OETF (Optical-Electrical Transfer Function). The conversion from code value to display linear light is called the EOTF (Electrical-Optical Transfer Function). It is particularly important to note that the OETF is not the inverse of the EOTF. The conversion from display linear light to code value should use the inverse of the EOTF, not the OETF. Similarly, the conversion from code value to scene linear light should use the inverse of the OETF, not the EOTF.\nThe conversion relationships between scene light, display light, and code values actually only require two transfer functions. PQ uses the EOTF and OOTF, while HLG uses the OETF and OOTF. In BT.2100, the PQ OETF is equivalent to the OOTF followed by the inverse EOTF, and the HLG EOTF is equivalent to the inverse OETF followed by the OOTF.\nThe colour library provides implementations of these transfer functions, including the PQ OETF and the HLG EOTF.\nPQ PQ is display-referred. The complete conversion process is: use the OOTF to convert scene linear light to display linear light, then use the inverse EOTF to convert display linear light to a code value. During display, the EOTF is used to convert the code value back to display linear light.\nLet‚Äôs start by setting the display luminance of diffuse white to 203 nits. The corresponding scene linear light is obtained using the inverse OOTF. In scene linear light, the ratio of the grey card to diffuse white is 0.18. We can calculate the scene light for the grey card and then apply the OOTF to get its display linear light (26 nits). By applying the inverse EOTF to the display linear light of both diffuse white and the grey card, we get their corresponding code values.\ndisp_lin_white = 203 scene_lin_white = colour.models.ootf_inverse_BT2100_PQ(disp_lin_white) print(\"Scene Linear:\", scene_lin_white) # 0.0307311888745 scene_lin_grey = scene_lin_white * 0.18 print(\"Scene Linear Grey:\", scene_lin_grey) # 0.00553161399741 disp_lin_grey = colour.models.ootf_BT2100_PQ(scene_lin_grey) print(\"Display Linear Grey:\", disp_lin_grey) # 25.6890888306 signal_white = colour.models.eotf_inverse_BT2100_PQ(disp_lin_white) print(\"Signal White:\", signal_white) # 0.580688881042 signal_grey = colour.models.eotf_inverse_BT2100_PQ(disp_lin_grey) print(\"Signal Grey:\", signal_grey) # 0.378961634455 HLG HLG is scene-referred. The complete conversion process is: use the OETF to convert scene linear light to a code value. During decoding, use the inverse OETF to convert the code value back to scene linear light, and then use the OOTF to convert the scene linear light to display linear light.\nSimilarly, we set the display luminance of diffuse white to 203 nits. The corresponding scene linear light is obtained using the inverse OOTF. In scene linear light, the ratio of the grey card to diffuse white is 0.18. We calculate the scene light for the grey card, apply the OETF to the scene light to get the code value, and apply the OOTF to the scene light to get the display linear light.\ndisp_lin_white = 203 scene_lin_white = colour.models.ootf_inverse_BT2100_HLG(disp_lin_white) print(\"Scene Linear:\", scene_lin_white) # 0.264797185624 scene_lin_grey = scene_lin_white * 0.18 print(\"Scene Linear Grey:\", scene_lin_grey) # 0.0476634934123 disp_lin_grey = colour.models.ootf_BT2100_HLG(scene_lin_grey) print(\"Display Linear Grey:\", disp_lin_grey) # 25.9312256307 signal_white = colour.models.oetf_BT2100_HLG(scene_lin_white) print(\"Signal White:\", signal_white) # 0.749877364632 signal_grey = colour.models.oetf_BT2100_HLG(scene_lin_grey) print(\"Signal Grey:\", signal_grey) # 0.378140820644 It is worth noting that the HLG OOTF changes with the peak luminance of the display. If no parameters are passed, colour defaults to a peak luminance of 1000 nits, for which the corresponding OOTF is a gamma of 1.2. Additionally, the HLG OOTF should be applied to the RGB components; passing only a luminance value will raise a warning, but the approach and the result are correct.\nA Few Afterthoughts As for why the OETF and EOTF cannot be used as inverse functions of each other, it is precisely because the OOTF is at play. In the most ideal scenario, where the display perfectly reproduces the scene light, the OOTF would be a linear function. In that case, the OETF and EOTF would be inverse functions (with a luminance coefficient).\nThe OOTF used by PQ is a combination of the BT.709 OETF and the BT.1886 EOTF, with a curvature between linear and a gamma of 1.2. The OOTF used by HLG is a luminance-dependent gamma function, which is a gamma of 1.2 at 1000 nits.\nPersonally, I feel that understanding these transfer functions is necessary, especially in HDR systems where conversions between different transfer functions are often required. The table in BT.2408 provides a good reference, but in practical applications, these transfer functions, especially the OOTF, are rarely referenced directly. When creating PQ content, adjustments are typically made with respect to display light, and then the inverse EOTF is used to convert to code values, without involving the OOTF. The design of HLG to use an OOTF is more likely for compatibility with SDR systems and broadcast production.\nThis small experiment also serves as good proof that as long as the calculations are correct, the results obtained using either transfer function will be the same (aside from quantisation differences). It is not the case that using HLG will produce a different effect from PQ.\nEnglish Lesson In the issue, there is a sentence: Now, the penny finally dropped.\nThis expression originates from old-fashioned vending machines, which required a coin to be inserted before they would operate. Sometimes the coin would get stuck and only fall into place after a moment, at which point the machine would start working. Therefore, this phrase is a metaphor for ‚Äòsuddenly understanding‚Äô or ‚Äògrasping something one didn‚Äôt understand before‚Äô.\n",
  "wordCount" : "1279",
  "inLanguage": "en",
  "image": "https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp","datePublished": "2025-05-26T02:00:00+08:00",
  "dateModified": "2025-05-26T02:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Jack"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jackchou.top/en/posts/bt2408/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "üè°JacksBlog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jackchou.top/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jackchou.top/en/" accesskey="h" title="üè°JacksBlog (Alt + H)">üè°JacksBlog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://jackchou.top/" title="‰∏≠Êñá"
                            aria-label="‰∏≠Êñá">‰∏≠Êñá</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jackchou.top/en/posts/" title="Posts üå≥">
                    <span>Posts üå≥</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/photos/" title="Photos üì∑">
                    <span>Photos üì∑</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/tags/" title="Tags üè∑Ô∏è">
                    <span>Tags üè∑Ô∏è</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/about/" title="About üòº">
                    <span>About üòº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      A Small Experiment to Help Understand HDR Transfer Functions
    </h1>
    <div class="post-meta"><span title='2025-05-26 02:00:00 +0800 +0800'>2025.05.26</span>&nbsp;¬∑&nbsp;Jack&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="https://jackchou.top/posts/bt2408/">‰∏≠Êñá</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#bt2408-and-the-problem" aria-label="BT.2408 and the Problem">BT.2408 and the Problem</a></li>
                <li>
                    <a href="#theory" aria-label="Theory">Theory</a></li>
                <li>
                    <a href="#pq" aria-label="PQ">PQ</a></li>
                <li>
                    <a href="#hlg" aria-label="HLG">HLG</a></li>
                <li>
                    <a href="#a-few-afterthoughts" aria-label="A Few Afterthoughts">A Few Afterthoughts</a></li>
                <li>
                    <a href="#english-lesson" aria-label="English Lesson">English Lesson</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p><em>I realised I haven&rsquo;t written a blog post in a while. I actually have many drafts, but they are all in a state of being unfinished.</em></p>
<p>I&rsquo;m porting over an issue from GitHub that helps with the correct use and understanding of various HDR transfer functions.</p>
<p><a href="https://github.com/colour-science/colour/issues/1348">https://github.com/colour-science/colour/issues/1348</a></p>
<p>The gist of the issue is that, following Table 1 of BT.2408, if you place diffuse white at a display luminance of 203.0 nits, the calculated display luminance for an 18% grey card is not 26 nits.</p>
<h2 id="bt2408-and-the-problem">BT.2408 and the Problem<a hidden class="anchor" aria-hidden="true" href="#bt2408-and-the-problem">#</a></h2>
<p>BT.2408 is a standard concerning operational practices for HDR. Table 1 recommends the display luminance and corresponding code values under different transfer functions for several objects.</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Reflectance Object or Reference (Luminance Factor, %)</th>
          <th style="text-align: left">Nominal Luminance, cd/m¬≤ (PQ &amp; 1000 cd/m¬≤ HLG)</th>
          <th style="text-align: left">Nominal Signal Level</th>
          <th style="text-align: left">Nominal Signal Level</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Grey Card (18%)</td>
          <td style="text-align: left">26</td>
          <td style="text-align: left">38</td>
          <td style="text-align: left">38</td>
      </tr>
      <tr>
          <td style="text-align: left">Greyscale Chart Max (83%)</td>
          <td style="text-align: left">162</td>
          <td style="text-align: left">56</td>
          <td style="text-align: left">71</td>
      </tr>
      <tr>
          <td style="text-align: left">Greyscale Chart Max (90%)</td>
          <td style="text-align: left">179</td>
          <td style="text-align: left">57</td>
          <td style="text-align: left">73</td>
      </tr>
      <tr>
          <td style="text-align: left">Reference Level: HDR Reference White (100%) also diffuse white and Graphics White</td>
          <td style="text-align: left">203</td>
          <td style="text-align: left">58</td>
          <td style="text-align: left">75</td>
      </tr>
  </tbody>
</table>
<p>The question is how to use HDR transfer functions to convert between these numbers, for instance, using Python&rsquo;s <code>colour</code> library.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> colour
</span></span></code></pre></div><h2 id="theory">Theory<a hidden class="anchor" aria-hidden="true" href="#theory">#</a></h2>
<p>The table is divided into three parts. The first column is reflectance, corresponding to scene-referred linear light. The second column is display luminance, which is display-referred linear light. The last two columns are the code values for the two systems.</p>
<p>Their numerical ranges are:</p>
<ul>
<li>Scene Light: 0.0 - 1.0. This is relative and, for example, in a photography system, is controlled by the camera&rsquo;s exposure. The scene light for a grey card and diffuse white could be 0.18 and 1.0, or it could be 0.018 and 0.1.</li>
<li>Display Light: 0.0 - 10000 nits. This is absolute in an HDR system. For the HLG system, a peak luminance must be specified, for example, 1000 nits.</li>
<li>Code Value: 0 - 255 or 0 - 1023, depending on the system&rsquo;s bit depth. It can also be represented by floating-point numbers from 0.0 - 1.0. Personally, I find floating-point numbers easier to work with.</li>
</ul>
<p>A transfer function system defines how to perform these conversions between luminance and code values.</p>
<ul>
<li>The conversion from scene linear light to display linear light is called the opto-opto transfer function (OOTF).</li>
<li>The conversion from scene linear light to code value is called the OETF (Optical-Electrical Transfer Function).</li>
<li>The conversion from code value to display linear light is called the EOTF (Electrical-Optical Transfer Function).</li>
</ul>
<p>It is particularly important to note that the OETF is not the inverse of the EOTF. The conversion from display linear light to code value should use the inverse of the EOTF, not the OETF. Similarly, the conversion from code value to scene linear light should use the inverse of the OETF, not the EOTF.</p>
<p>The conversion relationships between scene light, display light, and code values actually only require two transfer functions. PQ uses the EOTF and OOTF, while HLG uses the OETF and OOTF. In BT.2100, the PQ OETF is equivalent to the OOTF followed by the inverse EOTF, and the HLG EOTF is equivalent to the inverse OETF followed by the OOTF.</p>
<p>The <code>colour</code> library provides implementations of these transfer functions, including the PQ OETF and the HLG EOTF.</p>
<h2 id="pq">PQ<a hidden class="anchor" aria-hidden="true" href="#pq">#</a></h2>
<p>PQ is display-referred. The complete conversion process is: use the OOTF to convert scene linear light to display linear light, then use the inverse EOTF to convert display linear light to a code value. During display, the EOTF is used to convert the code value back to display linear light.</p>
<p>Let&rsquo;s start by setting the display luminance of diffuse white to 203 nits. The corresponding scene linear light is obtained using the inverse OOTF. In scene linear light, the ratio of the grey card to diffuse white is 0.18. We can calculate the scene light for the grey card and then apply the OOTF to get its display linear light (26 nits). By applying the inverse EOTF to the display linear light of both diffuse white and the grey card, we get their corresponding code values.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>disp_lin_white <span style="color:#f92672">=</span> <span style="color:#ae81ff">203</span>
</span></span><span style="display:flex;"><span>scene_lin_white <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>ootf_inverse_BT2100_PQ(disp_lin_white)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Scene Linear:&#34;</span>, scene_lin_white)  <span style="color:#75715e"># 0.0307311888745</span>
</span></span><span style="display:flex;"><span>scene_lin_grey <span style="color:#f92672">=</span> scene_lin_white <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.18</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Scene Linear Grey:&#34;</span>, scene_lin_grey)  <span style="color:#75715e"># 0.00553161399741</span>
</span></span><span style="display:flex;"><span>disp_lin_grey <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>ootf_BT2100_PQ(scene_lin_grey)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Display Linear Grey:&#34;</span>, disp_lin_grey)  <span style="color:#75715e"># 25.6890888306</span>
</span></span><span style="display:flex;"><span>signal_white <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>eotf_inverse_BT2100_PQ(disp_lin_white)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Signal White:&#34;</span>, signal_white)  <span style="color:#75715e"># 0.580688881042</span>
</span></span><span style="display:flex;"><span>signal_grey <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>eotf_inverse_BT2100_PQ(disp_lin_grey)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Signal Grey:&#34;</span>, signal_grey)  <span style="color:#75715e"># 0.378961634455</span>
</span></span></code></pre></div><h2 id="hlg">HLG<a hidden class="anchor" aria-hidden="true" href="#hlg">#</a></h2>
<p>HLG is scene-referred. The complete conversion process is: use the OETF to convert scene linear light to a code value. During decoding, use the inverse OETF to convert the code value back to scene linear light, and then use the OOTF to convert the scene linear light to display linear light.</p>
<p>Similarly, we set the display luminance of diffuse white to 203 nits. The corresponding scene linear light is obtained using the inverse OOTF. In scene linear light, the ratio of the grey card to diffuse white is 0.18. We calculate the scene light for the grey card, apply the OETF to the scene light to get the code value, and apply the OOTF to the scene light to get the display linear light.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>disp_lin_white <span style="color:#f92672">=</span> <span style="color:#ae81ff">203</span>
</span></span><span style="display:flex;"><span>scene_lin_white <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>ootf_inverse_BT2100_HLG(disp_lin_white)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Scene Linear:&#34;</span>, scene_lin_white)  <span style="color:#75715e"># 0.264797185624</span>
</span></span><span style="display:flex;"><span>scene_lin_grey <span style="color:#f92672">=</span> scene_lin_white <span style="color:#f92672">*</span> <span style="color:#ae81ff">0.18</span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Scene Linear Grey:&#34;</span>, scene_lin_grey)  <span style="color:#75715e"># 0.0476634934123</span>
</span></span><span style="display:flex;"><span>disp_lin_grey <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>ootf_BT2100_HLG(scene_lin_grey)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Display Linear Grey:&#34;</span>, disp_lin_grey)  <span style="color:#75715e"># 25.9312256307</span>
</span></span><span style="display:flex;"><span>signal_white <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>oetf_BT2100_HLG(scene_lin_white)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Signal White:&#34;</span>, signal_white)  <span style="color:#75715e"># 0.749877364632</span>
</span></span><span style="display:flex;"><span>signal_grey <span style="color:#f92672">=</span> colour<span style="color:#f92672">.</span>models<span style="color:#f92672">.</span>oetf_BT2100_HLG(scene_lin_grey)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Signal Grey:&#34;</span>, signal_grey)  <span style="color:#75715e"># 0.378140820644</span>
</span></span></code></pre></div><p>It is worth noting that the HLG OOTF changes with the peak luminance of the display. If no parameters are passed, <code>colour</code> defaults to a peak luminance of 1000 nits, for which the corresponding OOTF is a gamma of 1.2. Additionally, the HLG OOTF should be applied to the RGB components; passing only a luminance value will raise a warning, but the approach and the result are correct.</p>
<h2 id="a-few-afterthoughts">A Few Afterthoughts<a hidden class="anchor" aria-hidden="true" href="#a-few-afterthoughts">#</a></h2>
<p>As for why the OETF and EOTF cannot be used as inverse functions of each other, it is precisely because the OOTF is at play. In the most ideal scenario, where the display perfectly reproduces the scene light, the OOTF would be a linear function. In that case, the OETF and EOTF would be inverse functions (with a luminance coefficient).</p>
<p>The OOTF used by PQ is a combination of the BT.709 OETF and the BT.1886 EOTF, with a curvature between linear and a gamma of 1.2. The OOTF used by HLG is a luminance-dependent gamma function, which is a gamma of 1.2 at 1000 nits.</p>
<p>Personally, I feel that understanding these transfer functions is necessary, especially in HDR systems where conversions between different transfer functions are often required. The table in BT.2408 provides a good reference, but in practical applications, these transfer functions, especially the OOTF, are rarely referenced directly. When creating PQ content, adjustments are typically made with respect to display light, and then the inverse EOTF is used to convert to code values, without involving the OOTF. The design of HLG to use an OOTF is more likely for compatibility with SDR systems and broadcast production.</p>
<p>This small experiment also serves as good proof that as long as the calculations are correct, the results obtained using either transfer function will be the same (aside from quantisation differences). It is not the case that using HLG will produce a different effect from PQ.</p>
<h2 id="english-lesson">English Lesson<a hidden class="anchor" aria-hidden="true" href="#english-lesson">#</a></h2>
<p>In the issue, there is a sentence: Now, the penny finally dropped.</p>
<p>This expression originates from old-fashioned vending machines, which required a coin to be inserted before they would operate. Sometimes the coin would get stuck and only fall into place after a moment, at which point the machine would start working. Therefore, this phrase is a metaphor for &lsquo;suddenly understanding&rsquo; or &lsquo;grasping something one didn&rsquo;t understand before&rsquo;.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://jackchou.top/en/tags/colour/">Colour</a></li>
      <li><a href="https://jackchou.top/en/tags/hdr/">HDR</a></li>
      <li><a href="https://jackchou.top/en/tags/display/">Display</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://jackchou.top/en/">üè°JacksBlog</a></span> ¬∑ 
        my friends&rsquo; websites: <a href="https://zhxwu.com/">zhxwu.com</a>, <a href="https://ylqian.com/">ylqian.com</a> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><div style="text-align: center; margin-top: 10px; margin-bottom: 20px; width: 100%; display: flex; justify-content: center;">
    <img src="https://visitor-badge.laobi.icu/badge?page_id=jacksblog" alt="visitors" style="max-width: 120px; height: auto;" />
</div><script>
(() => {
    const images = document.querySelectorAll('.post-content img');
    if (!images.length) return;

    const overlay = document.createElement('div');
    overlay.className = 'image-lightbox';
    overlay.innerHTML = '<img class="image-lightbox__img" alt="" />';

    const overlayImg = overlay.querySelector('img');
    const closeOverlay = () => {
        overlay.classList.remove('is-visible');
        overlayImg.removeAttribute('src');
        document.body.style.removeProperty('overflow');
    };

    overlay.addEventListener('click', closeOverlay);
    document.addEventListener('keyup', (event) => {
        if (event.key === 'Escape' && overlay.classList.contains('is-visible')) {
            closeOverlay();
        }
    });

    document.body.appendChild(overlay);

    images.forEach((img) => {
        img.addEventListener('click', (event) => {
            event.preventDefault();
            event.stopPropagation();

            const source = img.dataset.zoomSrc || img.currentSrc || img.src;
            const cleanSrc = source.split('#')[0];

            overlayImg.src = cleanSrc;
            overlayImg.alt = img.alt || '';

            overlay.classList.add('is-visible');
            document.body.style.setProperty('overflow', 'hidden');
        });
    });
})();
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
