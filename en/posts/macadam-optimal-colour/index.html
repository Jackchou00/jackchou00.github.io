<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MacAdam&#39;s Optimal Colours: The Boundary of Physical Colours | üè°JacksBlog</title>
<meta name="keywords" content="Colour">
<meta name="description" content="Is there a theoretical limit to the colours an object can display? This question began with Schr√∂dinger and MacAdam. This article will explore the theory, proof, and calculation methods for &#39;optimal colours&#39;.">
<meta name="author" content="Jack">
<link rel="canonical" href="https://jackchou.top/en/posts/macadam-optimal-colour/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.556aa244931a2b8641244b3a88ba5d10d011bee5ef6cc4a8df29bb3ab8574aa9.css" integrity="sha256-VWqiRJMaK4ZBJEs6iLpdENARvuXvbMSo3ym7OrhXSqk=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://jackchou.top/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jackchou.top/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jackchou.top/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jackchou.top/apple-touch-icon.png">
<link rel="mask-icon" href="https://jackchou.top/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh-cn" href="https://jackchou.top/posts/macadam-optimal-colour/">
<link rel="alternate" hreflang="en" href="https://jackchou.top/en/posts/macadam-optimal-colour/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js" integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>


<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@100..900&family=Sen:wght@400..800&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet"><meta property="og:url" content="https://jackchou.top/en/posts/macadam-optimal-colour/">
  <meta property="og:site_name" content="üè°JacksBlog">
  <meta property="og:title" content="MacAdam&#39;s Optimal Colours: The Boundary of Physical Colours">
  <meta property="og:description" content="Is there a theoretical limit to the colours an object can display? This question began with Schr√∂dinger and MacAdam. This article will explore the theory, proof, and calculation methods for &#39;optimal colours&#39;.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-09-07T20:00:00+08:00">
    <meta property="article:modified_time" content="2025-09-07T20:00:00+08:00">
    <meta property="article:tag" content="Colour">
      <meta property="og:image" content="https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp">
<meta name="twitter:title" content="MacAdam&#39;s Optimal Colours: The Boundary of Physical Colours">
<meta name="twitter:description" content="Is there a theoretical limit to the colours an object can display? This question began with Schr√∂dinger and MacAdam. This article will explore the theory, proof, and calculation methods for &#39;optimal colours&#39;.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts üå≥",
      "item": "https://jackchou.top/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "MacAdam's Optimal Colours: The Boundary of Physical Colours",
      "item": "https://jackchou.top/en/posts/macadam-optimal-colour/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MacAdam's Optimal Colours: The Boundary of Physical Colours",
  "name": "MacAdam\u0027s Optimal Colours: The Boundary of Physical Colours",
  "description": "Is there a theoretical limit to the colours an object can display? This question began with Schr√∂dinger and MacAdam. This article will explore the theory, proof, and calculation methods for 'optimal colours'.",
  "keywords": [
    "Colour"
  ],
  "articleBody": "Schr√∂dinger‚Äôs Optimal Pigments Yes, that Schr√∂dinger.\nAs early as 1920, Schr√∂dinger published a paper titled Theorie der Pigmente von gr√∂√üter Leuchtkraft. The original text was in German, but thankfully, we now have multilingual LLMs to help. The paper broadly discusses the reflective properties of various pigments, why the colour saturation achievable by pigments is less than that of pure spectral light, and deduces a theoretical ‚Äúoptimal pigment‚Äù. This pigment has a binary reflectance spectrum with respect to wavelength‚Äîit either reflects light completely or not at all.\nAt that time, the CIE had not yet introduced the CIE 1931 XYZ colour matching functions, and this was also before the 1924 $V(\\lambda)$ function. The definition of ‚Äúluminance‚Äù (Helligkeit) in the paper was related to a ‚Äúquantity‚Äù (Quantit√§t), which was a combination of three colour quantities‚Äîa precursor to later concepts of colour matching functions and luminance. Discussions about optimal colours began even when fundamental concepts like luminance were still vague, making it one of the topics with the richest history in colour science.\nMacAdam‚Äôs Optimal Colours By 1935, with quantified standards for luminance and colour established, MacAdam published a paper proposing the concept of optimal colours, described in the original text as ‚ÄúMaximum Visual Efficiency of Colored Materials‚Äù.\nMacAdam‚Äôs optimal colours form the outer surface of the ‚Äútheoretical object colour solid‚Äù in the luminance dimension. That is, they represent the upper limit of luminance for the set of colours that any object relying solely on reflection (non-fluorescent, non-emissive) can theoretically produce under a specific illuminant. This solid is defined by all physically possible reflectance spectra and contains all real object colours, with its surface representing the theoretical limits.\nAn Optimal Colour refers to the colour corresponding to the maximum achievable luminance for each set of chromaticity coordinates (x, y or u‚Äô, v‚Äô), i.e., ‚Äúthe theoretical object colour with the highest luminance for a given chromaticity‚Äù. For example, here is a false-colour plot of the luminance of MacAdam‚Äôs optimal colours under a certain illuminant.\nThe reflectance functions required to achieve these optimal colours take the form of a ‚Äúbinary square-wave‚Äù with only two transition points. Although such reflectance spectra are impossible to achieve in reality, they constitute the theoretical ceiling for object colours.\nProof of the Square-Wave Reflectance Both Schr√∂dinger and MacAdam proved that to achieve an optimal colour, its reflectance must be a binary square-wave with no more than two transition points. Their proofs were based on physical analysis and intuition.\nBelow, we will use the calculus of variations and the Lagrange multiplier method to prove mathematically that for any given chromaticity coordinates, the reflectance that achieves maximum luminance is a ‚Äúsquare-wave‚Äù.\nLet‚Äôs first express these conditions and the problem in mathematical language:\nThe Problem Statement Reflectance R, a function of wavelength $\\lambda$, with values between 0 and 1. Colour Matching Functions (CMFs), used to convert a spectral power distribution into tristimulus values XYZ, are also functions of wavelength, denoted as $\\bar{x}$, $\\bar{y}$, and $\\bar{z}$. The spectral power distribution of the illuminant I and the reflected spectral power distribution P. Any given chromaticity coordinates $x_0$, $y_0$. $$ P(\\lambda) = R(\\lambda)I(\\lambda), \\quad \\text{where } 0 \\le R(\\lambda) \\le 1 $$$$ \\begin{aligned} X \u0026= k \\int P(\\lambda) \\bar{x}(\\lambda) \\, d\\lambda \\\\ Y \u0026= k \\int P(\\lambda) \\bar{y}(\\lambda) \\, d\\lambda \\\\ Z \u0026= k \\int P(\\lambda) \\bar{z}(\\lambda) \\, d\\lambda \\end{aligned} $$$$ x_{0} = x = \\frac{X}{X + Y + Z}, \\quad y_{0} = y = \\frac{Y}{X + Y + Z} $$To prove: for given chromaticity coordinates $(x_{0}, y_{0})$, there exists a reflectance function $R(\\lambda)$ that maximises $Y$. At this maximum, the value of $R(\\lambda)$ can only be 0 or 1.\nDetailed Proof We can prove using the calculus of variations and the Lagrange multiplier method that for any given chromaticity, the reflectance spectrum that achieves maximum luminance must be a ‚Äúsquare-wave‚Äù function, taking values of only 0 or 1.\nTo make the derivation clearer, we will proceed in two steps: first, proving the conclusion under an idealised equal-energy illuminant; then, generalising this conclusion to any illuminant to show that the illuminant‚Äôs spectral distribution does not affect the ‚Äúsquare-wave‚Äù form of the optimal reflectance.\nStep 1: Proof under an Equal-Energy Illuminant Let‚Äôs first assume the illuminant has an equal-energy spectrum, meaning its spectral power distribution $I(\\lambda)$ is a constant. To simplify calculations, we can set $I(\\lambda)=1$ and $k=1$. The tristimulus values are then:\n$$ X = \\int R(\\lambda) \\bar{x}(\\lambda) \\, d\\lambda, \\quad Y = \\int R(\\lambda) \\bar{y}(\\lambda) \\, d\\lambda, \\quad Z = \\int R(\\lambda) \\bar{z}(\\lambda) \\, d\\lambda $$Our goal is to maximise luminance $Y$ subject to the chromaticity coordinate constraints $(x_0, y_0)$. The objective function is:\n$$ \\text{Maximise} \\quad Y = \\int R(\\lambda) \\bar{y}(\\lambda) \\, d\\lambda $$The chromaticity constraints $x=x_0$ and $y=y_0$ can be transformed into two equivalent linear constraints. For notational simplicity, we define $z_0 = 1 - x_0 - y_0$. The constraints are:\n$$ \\int R(\\lambda) \\left( \\bar{x}(\\lambda) - \\frac{x_0}{y_0} \\bar{y}(\\lambda) \\right) d\\lambda = 0 $$$$ \\int R(\\lambda) \\left( \\bar{z}(\\lambda) - \\frac{z_0}{y_0} \\bar{y}(\\lambda) \\right) d\\lambda = 0 $$This is a constrained optimisation problem. We introduce Lagrange multipliers $\\mu_1, \\mu_2$ to construct an auxiliary functional $J[R]$. By combining the objective function and the constraints, the problem is transformed into maximising $J[R]$:\n$$ J[R] = \\int R(\\lambda) f(\\lambda) \\, d\\lambda $$where the core part of the integrand, $f(\\lambda)$, is given by:\n$$ f(\\lambda) = \\bar{y}(\\lambda) - \\mu_1 \\left( \\bar{x}(\\lambda) - \\frac{x_0}{y_0} \\bar{y}(\\lambda) \\right) - \\mu_2 \\left( \\bar{z}(\\lambda) - \\frac{z_0}{y_0} \\bar{y}(\\lambda) \\right) $$Rearranging the above equation by the colour matching functions (CMFs), we get:\n$$ f(\\lambda) = c_1 \\bar{x}(\\lambda) + c_2 \\bar{y}(\\lambda) + c_3 \\bar{z}(\\lambda) $$Here, $c_1, c_2, c_3$ are constants that depend only on $(x_0, y_0)$ and the multipliers $(\\mu_1, \\mu_2)$. This shows that $f(\\lambda)$ is always a linear combination of the CMFs.\nTo maximise the integral $J[R]$ under the physical constraint $0 \\le R(\\lambda) \\le 1$, we must independently maximise the integrand term $R(\\lambda) f(\\lambda)$ at each wavelength $\\lambda$:\nIf $f(\\lambda) \u003e 0$, we should choose $R(\\lambda) = 1$. If $f(\\lambda) \u003c 0$, we should choose $R(\\lambda) = 0$. If $f(\\lambda) = 0$, the value of $R(\\lambda)$ does not affect the result, and these points form the transition points from 0 to 1. Therefore, the optimal reflectance $R(\\lambda)$ can only take values of 0 or 1. Its graph has a ‚Äúsquare-wave‚Äù shape, and its transition points are the zero-crossing points of this linear combination of CMFs.\nStep 2: Generalisation to Any Illuminant Now, let‚Äôs consider an arbitrary illuminant $I(\\lambda)$, where $I(\\lambda) \u003e 0$. The tristimulus value formulae become:\n$$ X = k \\int R(\\lambda) I(\\lambda) \\bar{x}(\\lambda) \\, d\\lambda $$and similar forms for $Y$ and $Z$.\nRepeating the derivation above, each integral term in the objective function and constraints will be multiplied by $I(\\lambda)$. The final auxiliary functional becomes:\n$$ J[R] = \\int R(\\lambda) I(\\lambda) f(\\lambda) \\, d\\lambda $$where the definition of $f(\\lambda)$ is identical to that in the first step. It is still a linear combination of the CMFs, and its form does not depend on the illuminant.\nTo maximise $J[R]$, we need to maximise $R(\\lambda) I(\\lambda) f(\\lambda)$ at each wavelength. Since the illuminant‚Äôs spectral distribution $I(\\lambda)$ is always positive, the sign of this term is determined entirely by the sign of $f(\\lambda)$. Therefore, the strategy for choosing $R(\\lambda)$ is exactly the same as in the first step.\nThis proves that for any illuminant, the optimal colour at a specific chromaticity must correspond to a square-wave reflectance spectrum with values of only 0 and 1. Its ‚Äúshape‚Äù (i.e., the positions of the 0/1 transition points) is determined solely by the linear combination of the CMFs and is independent of the illuminant.\nCalculation Method for MacAdam‚Äôs Optimal Colours One direct approach is: for a given set of chromaticity coordinates xy, solve for the corresponding Lagrange multipliers $\\mu_1, \\mu_2$, then find the zero-crossing wavelengths of the linear combination of CMFs, and use these to construct the square-wave reflectance and calculate the corresponding luminance. However, solving for the Lagrange multipliers from xy is a non-linear process with no explicit solution. Instead, the problem can be approached from another angle to quickly solve for the optimal colour‚Äôs luminance.\nThe key insight is that a linear combination of the CMFs can, in most cases, produce at most two zero-crossing points (excluding the endpoints), making the square-wave reflectance either a band-pass or a band-stop filter.\nUsing this property, we can quickly iterate through all possible reflectances to build a two-dimensional look-up table that returns the maximum luminance for a given set of chromaticity coordinates.\nThe specific procedure is to define two cut-off wavelengths, $\\lambda_1$ and $\\lambda_2$. One moves from short to long wavelengths, while the other moves from long to short wavelengths. For each pair, we calculate the chromaticity coordinates and luminance for both the band-pass and band-stop reflectances they define. This generates a look-up table of the form $Y=f(x,y)$.\nSignificance MacAdam‚Äôs optimal colours serve as a theoretical benchmark for measuring the colour reproduction capabilities of devices like printers. The gamut of any reflective device cannot exceed the boundaries defined by the MacAdam limits, providing a theoretical ceiling for the development of colour management and wide-gamut technologies.\nIn the age of HDR, the concept of MacAdam‚Äôs optimal colours seems poised to find new applications and offer fresh inspiration.\n",
  "wordCount" : "1536",
  "inLanguage": "en",
  "image": "https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp","datePublished": "2025-09-07T20:00:00+08:00",
  "dateModified": "2025-09-07T20:00:00+08:00",
  "author":{
    "@type": "Person",
    "name": "Jack"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jackchou.top/en/posts/macadam-optimal-colour/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "üè°JacksBlog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jackchou.top/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jackchou.top/en/" accesskey="h" title="üè°JacksBlog (Alt + H)">üè°JacksBlog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://jackchou.top/" title="‰∏≠Êñá"
                            aria-label="‰∏≠Êñá">Zh-Cn</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jackchou.top/en/posts/" title="Posts üå≥">
                    <span>Posts üå≥</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/photos/" title="Photos üì∑">
                    <span>Photos üì∑</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/tags/" title="Tags üè∑Ô∏è">
                    <span>Tags üè∑Ô∏è</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/about/" title="About üòº">
                    <span>About üòº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      MacAdam&#39;s Optimal Colours: The Boundary of Physical Colours
    </h1>
    <div class="post-description">
      Is there a theoretical limit to the colours an object can display? This question began with Schr√∂dinger and MacAdam. This article will explore the theory, proof, and calculation methods for &#39;optimal colours&#39;.
    </div>
    <div class="post-meta"><span title='2025-09-07 20:00:00 +0800 +0800'>2025.09.07</span>&nbsp;¬∑&nbsp;Jack&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="https://jackchou.top/posts/macadam-optimal-colour/">Zh-Cn</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#schr%c3%b6dingers-optimal-pigments" aria-label="Schr√∂dinger&rsquo;s Optimal Pigments">Schr√∂dinger&rsquo;s Optimal Pigments</a></li>
                <li>
                    <a href="#macadams-optimal-colours" aria-label="MacAdam&rsquo;s Optimal Colours">MacAdam&rsquo;s Optimal Colours</a></li>
                <li>
                    <a href="#proof-of-the-square-wave-reflectance" aria-label="Proof of the Square-Wave Reflectance">Proof of the Square-Wave Reflectance</a><ul>
                        
                <li>
                    <a href="#the-problem-statement" aria-label="The Problem Statement">The Problem Statement</a></li>
                <li>
                    <a href="#detailed-proof" aria-label="Detailed Proof">Detailed Proof</a><ul>
                        
                <li>
                    <a href="#step-1-proof-under-an-equal-energy-illuminant" aria-label="Step 1: Proof under an Equal-Energy Illuminant">Step 1: Proof under an Equal-Energy Illuminant</a></li>
                <li>
                    <a href="#step-2-generalisation-to-any-illuminant" aria-label="Step 2: Generalisation to Any Illuminant">Step 2: Generalisation to Any Illuminant</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#calculation-method-for-macadams-optimal-colours" aria-label="Calculation Method for MacAdam&rsquo;s Optimal Colours">Calculation Method for MacAdam&rsquo;s Optimal Colours</a></li>
                <li>
                    <a href="#significance" aria-label="Significance">Significance</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="schr√∂dingers-optimal-pigments">Schr√∂dinger&rsquo;s Optimal Pigments<a hidden class="anchor" aria-hidden="true" href="#schr√∂dingers-optimal-pigments">#</a></h2>
<p><em>Yes, that Schr√∂dinger.</em></p>
<p>As early as 1920, Schr√∂dinger published a paper titled <em>Theorie der Pigmente von gr√∂√üter Leuchtkraft</em>. The original text was in German, but thankfully, we now have multilingual LLMs to help. The paper broadly discusses the reflective properties of various pigments, why the colour saturation achievable by pigments is less than that of pure spectral light, and deduces a theoretical &ldquo;optimal pigment&rdquo;. This pigment has a binary reflectance spectrum with respect to wavelength‚Äîit either reflects light completely or not at all.</p>
<p>At that time, the CIE had not yet introduced the CIE 1931 XYZ colour matching functions, and this was also before the 1924 $V(\lambda)$ function. The definition of &ldquo;luminance&rdquo; (Helligkeit) in the paper was related to a &ldquo;quantity&rdquo; (Quantit√§t), which was a combination of three colour quantities‚Äîa precursor to later concepts of colour matching functions and luminance. Discussions about optimal colours began even when fundamental concepts like luminance were still vague, making it one of the topics with the richest history in colour science.</p>
<h2 id="macadams-optimal-colours">MacAdam&rsquo;s Optimal Colours<a hidden class="anchor" aria-hidden="true" href="#macadams-optimal-colours">#</a></h2>
<p>By 1935, with quantified standards for luminance and colour established, MacAdam published a paper proposing the concept of optimal colours, described in the original text as &ldquo;Maximum Visual Efficiency of Colored Materials&rdquo;.</p>
<p>MacAdam&rsquo;s optimal colours form the outer surface of the &ldquo;theoretical object colour solid&rdquo; in the luminance dimension. That is, they represent the upper limit of luminance for the set of colours that any object relying solely on reflection (non-fluorescent, non-emissive) can theoretically produce under a specific illuminant. This solid is defined by all physically possible reflectance spectra and contains all real object colours, with its surface representing the theoretical limits.</p>
<p>An Optimal Colour refers to the colour corresponding to the maximum achievable luminance for each set of chromaticity coordinates (x, y or u&rsquo;, v&rsquo;), i.e., &ldquo;the theoretical object colour with the highest luminance for a given chromaticity&rdquo;. For example, here is a false-colour plot of the luminance of MacAdam&rsquo;s optimal colours under a certain illuminant.</p>
<p><img alt="A false-colour plot of luminance for MacAdam optimal colours under a certain illuminant" loading="lazy" src="https://img.jackchou.top/jack-img/2025/09/dd7522a807af7fc712b334b74820c62c.webp"></p>
<p>The reflectance functions required to achieve these optimal colours take the form of a &ldquo;binary square-wave&rdquo; with only two transition points. Although such reflectance spectra are impossible to achieve in reality, they constitute the theoretical ceiling for object colours.</p>
<h2 id="proof-of-the-square-wave-reflectance">Proof of the Square-Wave Reflectance<a hidden class="anchor" aria-hidden="true" href="#proof-of-the-square-wave-reflectance">#</a></h2>
<p>Both Schr√∂dinger and MacAdam proved that to achieve an optimal colour, its reflectance must be a binary square-wave with no more than two transition points. Their proofs were based on physical analysis and intuition.</p>
<p>Below, we will use the calculus of variations and the Lagrange multiplier method to prove mathematically that for any given chromaticity coordinates, the reflectance that achieves maximum luminance is a &ldquo;square-wave&rdquo;.</p>
<p>Let&rsquo;s first express these conditions and the problem in mathematical language:</p>
<h3 id="the-problem-statement">The Problem Statement<a hidden class="anchor" aria-hidden="true" href="#the-problem-statement">#</a></h3>
<ul>
<li>Reflectance R, a function of wavelength $\lambda$, with values between 0 and 1.</li>
<li>Colour Matching Functions (CMFs), used to convert a spectral power distribution into tristimulus values XYZ, are also functions of wavelength, denoted as $\bar{x}$, $\bar{y}$, and $\bar{z}$.</li>
<li>The spectral power distribution of the illuminant I and the reflected spectral power distribution P.</li>
<li>Any given chromaticity coordinates $x_0$, $y_0$.</li>
</ul>
$$
P(\lambda) = R(\lambda)I(\lambda), \quad \text{where } 0 \le R(\lambda) \le 1
$$$$
\begin{aligned}
X &= k \int P(\lambda) \bar{x}(\lambda) \, d\lambda \\
Y &= k \int P(\lambda) \bar{y}(\lambda) \, d\lambda \\
Z &= k \int P(\lambda) \bar{z}(\lambda) \, d\lambda
\end{aligned}
$$$$
x_{0} = x = \frac{X}{X + Y + Z}, \quad y_{0} = y = \frac{Y}{X + Y + Z}
$$<p>To prove: for given chromaticity coordinates $(x_{0}, y_{0})$, there exists a reflectance function $R(\lambda)$ that maximises $Y$. At this maximum, the value of $R(\lambda)$ can only be 0 or 1.</p>
<h3 id="detailed-proof">Detailed Proof<a hidden class="anchor" aria-hidden="true" href="#detailed-proof">#</a></h3>
<p>We can prove using the calculus of variations and the Lagrange multiplier method that for any given chromaticity, the reflectance spectrum that achieves maximum luminance must be a &ldquo;square-wave&rdquo; function, taking values of only 0 or 1.</p>
<p>To make the derivation clearer, we will proceed in two steps: first, proving the conclusion under an idealised equal-energy illuminant; then, generalising this conclusion to any illuminant to show that the illuminant&rsquo;s spectral distribution does not affect the &ldquo;square-wave&rdquo; form of the optimal reflectance.</p>
<h4 id="step-1-proof-under-an-equal-energy-illuminant">Step 1: Proof under an Equal-Energy Illuminant<a hidden class="anchor" aria-hidden="true" href="#step-1-proof-under-an-equal-energy-illuminant">#</a></h4>
<p>Let&rsquo;s first assume the illuminant has an equal-energy spectrum, meaning its spectral power distribution $I(\lambda)$ is a constant. To simplify calculations, we can set $I(\lambda)=1$ and $k=1$. The tristimulus values are then:</p>
$$
X = \int R(\lambda) \bar{x}(\lambda) \, d\lambda, \quad Y = \int R(\lambda) \bar{y}(\lambda) \, d\lambda, \quad Z = \int R(\lambda) \bar{z}(\lambda) \, d\lambda
$$<p>Our goal is to maximise luminance $Y$ subject to the chromaticity coordinate constraints $(x_0, y_0)$.
The objective function is:</p>
$$
\text{Maximise} \quad Y = \int R(\lambda) \bar{y}(\lambda) \, d\lambda
$$<p>The chromaticity constraints $x=x_0$ and $y=y_0$ can be transformed into two equivalent linear constraints. For notational simplicity, we define $z_0 = 1 - x_0 - y_0$. The constraints are:</p>
$$
\int R(\lambda) \left( \bar{x}(\lambda) - \frac{x_0}{y_0} \bar{y}(\lambda) \right) d\lambda = 0
$$$$
\int R(\lambda) \left( \bar{z}(\lambda) - \frac{z_0}{y_0} \bar{y}(\lambda) \right) d\lambda = 0
$$<p>This is a constrained optimisation problem. We introduce Lagrange multipliers $\mu_1, \mu_2$ to construct an auxiliary functional $J[R]$. By combining the objective function and the constraints, the problem is transformed into maximising $J[R]$:</p>
$$
J[R] = \int R(\lambda) f(\lambda) \, d\lambda
$$<p>where the core part of the integrand, $f(\lambda)$, is given by:</p>
$$
f(\lambda) = \bar{y}(\lambda) - \mu_1 \left( \bar{x}(\lambda) - \frac{x_0}{y_0} \bar{y}(\lambda) \right) - \mu_2 \left( \bar{z}(\lambda) - \frac{z_0}{y_0} \bar{y}(\lambda) \right)
$$<p>Rearranging the above equation by the colour matching functions (CMFs), we get:</p>
$$
f(\lambda) = c_1 \bar{x}(\lambda) + c_2 \bar{y}(\lambda) + c_3 \bar{z}(\lambda)
$$<p>Here, $c_1, c_2, c_3$ are constants that depend only on $(x_0, y_0)$ and the multipliers $(\mu_1, \mu_2)$. This shows that $f(\lambda)$ is always a linear combination of the CMFs.</p>
<p>To maximise the integral $J[R]$ under the physical constraint $0 \le R(\lambda) \le 1$, we must independently maximise the integrand term $R(\lambda) f(\lambda)$ at each wavelength $\lambda$:</p>
<ul>
<li>If $f(\lambda) > 0$, we should choose $R(\lambda) = 1$.</li>
<li>If $f(\lambda) < 0$, we should choose $R(\lambda) = 0$.</li>
<li>If $f(\lambda) = 0$, the value of $R(\lambda)$ does not affect the result, and these points form the transition points from 0 to 1.</li>
</ul>
<p>Therefore, the optimal reflectance $R(\lambda)$ can only take values of 0 or 1. Its graph has a &ldquo;square-wave&rdquo; shape, and its transition points are the zero-crossing points of this linear combination of CMFs.</p>
<h4 id="step-2-generalisation-to-any-illuminant">Step 2: Generalisation to Any Illuminant<a hidden class="anchor" aria-hidden="true" href="#step-2-generalisation-to-any-illuminant">#</a></h4>
<p>Now, let&rsquo;s consider an arbitrary illuminant $I(\lambda)$, where $I(\lambda) > 0$. The tristimulus value formulae become:</p>
$$
X = k \int R(\lambda) I(\lambda) \bar{x}(\lambda) \, d\lambda
$$<p>and similar forms for $Y$ and $Z$.</p>
<p>Repeating the derivation above, each integral term in the objective function and constraints will be multiplied by $I(\lambda)$. The final auxiliary functional becomes:</p>
$$
J[R] = \int R(\lambda) I(\lambda) f(\lambda) \, d\lambda
$$<p>where the definition of $f(\lambda)$ is identical to that in the first step. It is still a linear combination of the CMFs, and its form does not depend on the illuminant.</p>
<p>To maximise $J[R]$, we need to maximise $R(\lambda) I(\lambda) f(\lambda)$ at each wavelength. Since the illuminant&rsquo;s spectral distribution $I(\lambda)$ is always positive, the sign of this term is determined entirely by the sign of $f(\lambda)$. Therefore, the strategy for choosing $R(\lambda)$ is exactly the same as in the first step.</p>
<p>This proves that for any illuminant, the optimal colour at a specific chromaticity must correspond to a square-wave reflectance spectrum with values of only 0 and 1. Its &ldquo;shape&rdquo; (i.e., the positions of the 0/1 transition points) is determined solely by the linear combination of the CMFs and is independent of the illuminant.</p>
<h2 id="calculation-method-for-macadams-optimal-colours">Calculation Method for MacAdam&rsquo;s Optimal Colours<a hidden class="anchor" aria-hidden="true" href="#calculation-method-for-macadams-optimal-colours">#</a></h2>
<p>One direct approach is: for a given set of chromaticity coordinates xy, solve for the corresponding Lagrange multipliers $\mu_1, \mu_2$, then find the zero-crossing wavelengths of the linear combination of CMFs, and use these to construct the square-wave reflectance and calculate the corresponding luminance. However, solving for the Lagrange multipliers from xy is a non-linear process with no explicit solution. Instead, the problem can be approached from another angle to quickly solve for the optimal colour&rsquo;s luminance.</p>
<p>The key insight is that a linear combination of the CMFs can, in most cases, produce at most two zero-crossing points (excluding the endpoints), making the square-wave reflectance either a band-pass or a band-stop filter.</p>
<p>Using this property, we can quickly iterate through all possible reflectances to build a two-dimensional look-up table that returns the maximum luminance for a given set of chromaticity coordinates.</p>
<p>The specific procedure is to define two cut-off wavelengths, $\lambda_1$ and $\lambda_2$. One moves from short to long wavelengths, while the other moves from long to short wavelengths. For each pair, we calculate the chromaticity coordinates and luminance for both the band-pass and band-stop reflectances they define. This generates a look-up table of the form $Y=f(x,y)$.</p>
<h2 id="significance">Significance<a hidden class="anchor" aria-hidden="true" href="#significance">#</a></h2>
<p>MacAdam&rsquo;s optimal colours serve as a theoretical benchmark for measuring the colour reproduction capabilities of devices like printers. The gamut of any reflective device cannot exceed the boundaries defined by the MacAdam limits, providing a theoretical ceiling for the development of colour management and wide-gamut technologies.</p>
<p>In the age of HDR, the concept of MacAdam&rsquo;s optimal colours seems poised to find new applications and offer fresh inspiration.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://jackchou.top/en/tags/colour/">Colour</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://jackchou.top/en/">üè°JacksBlog</a></span> ¬∑ 
        my friends&rsquo; websites: <a href="https://zhxwu.com/">zhxwu.com</a>, <a href="https://ylqian.com/">ylqian.com</a> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><div style="text-align: center; margin-top: 10px; margin-bottom: 20px; width: 100%; display: flex; justify-content: center;">
    <img src="https://visitor-badge.laobi.icu/badge?page_id=jacksblog" alt="visitors" style="max-width: 120px; height: auto;" />
</div>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
