<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format | üè°JacksBlog</title>
<meta name="keywords" content="JPEG File Format, HDR Image, UltraHDR JPEG Format, Gainmap Metadata Structure, Hasselblad X2D II 100C, ISO 21496-1 Gain Map, HNCS HDR, Medium Format HDR">
<meta name="description" content="Hasselblad HNCS HDR outputs Ultra HDR JPEG with Gainmap and P3 color via Phocus, the first medium format camera with end-to-end HDR.">
<meta name="author" content="Jack, Tosaki Mk.II">
<link rel="canonical" href="https://jackchou.top/en/posts/x2dii-preview/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.e30af01949f15b214a659db89950589c44040efcfcdeec2087ad8629d77c216e.css" integrity="sha256-4wrwGUnxWyFKZZ24mVBYnEQEDvz83uwgh62GKdd8IW4=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://jackchou.top/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://jackchou.top/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://jackchou.top/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://jackchou.top/apple-touch-icon.png">
<link rel="mask-icon" href="https://jackchou.top/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="zh-cn" href="https://jackchou.top/posts/x2dii-preview/">
<link rel="alternate" hreflang="en" href="https://jackchou.top/en/posts/x2dii-preview/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><script type="text/javascript">
    (function (c, l, a, r, i, t, y) {
        c[a] = c[a] || function () { (c[a].q = c[a].q || []).push(arguments) };
        t = l.createElement(r); t.async = 1; t.src = "https://www.clarity.ms/tag/" + i;
        y = l.getElementsByTagName(r)[0]; y.parentNode.insertBefore(t, y);
    })(window, document, "clarity", "script", "u9z1afks70");
</script><meta property="og:url" content="https://jackchou.top/en/posts/x2dii-preview/">
  <meta property="og:site_name" content="üè°JacksBlog">
  <meta property="og:title" content="Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format">
  <meta property="og:description" content="Hasselblad HNCS HDR outputs Ultra HDR JPEG with Gainmap and P3 color via Phocus, the first medium format camera with end-to-end HDR.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-26T23:00:00+08:00">
    <meta property="article:modified_time" content="2025-09-28T00:57:34+08:00">
    <meta property="article:tag" content="Colour">
    <meta property="article:tag" content="HDR">
    <meta property="article:tag" content="Camera">
    <meta property="article:tag" content="UltraHDR">
      <meta property="og:image" content="https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp">
<meta name="twitter:title" content="Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format">
<meta name="twitter:description" content="Hasselblad HNCS HDR outputs Ultra HDR JPEG with Gainmap and P3 color via Phocus, the first medium format camera with end-to-end HDR.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts üå≥",
      "item": "https://jackchou.top/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format",
      "item": "https://jackchou.top/en/posts/x2dii-preview/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format",
  "name": "Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format",
  "description": "Hasselblad HNCS HDR outputs Ultra HDR JPEG with Gainmap and P3 color via Phocus, the first medium format camera with end-to-end HDR.",
  "keywords": [
    "JPEG File Format", "HDR Image", "UltraHDR JPEG Format", "Gainmap Metadata Structure", "Hasselblad X2D II 100C", "ISO 21496-1 Gain Map", "HNCS HDR", "Medium Format HDR"
  ],
  "articleBody": "The JPEG File Format of HNCS HDR Let‚Äôs set aside the specific implementation details of HNCS HDR for a moment and look at how Hasselblad chose the file format to store its HDR output.\nThe X2D II 100C is the first medium format camera to support end-to-end HDR capabilities, capable of outputting HDR HEIF or Ultra HDR JPEG photos directly in-camera.\nDPReview released a sample gallery for the X2D II immediately, providing in-camera straight-out JPG and RAW downloads. According to Hasselblad, this JPG complies with the UltraHDR standard.\nLet‚Äôs examine the internal details of the file:\nThe file contains four complete JPEG structures, with resolutions as follows:\n11656x8742, 5828x4370, 3888x2918, 2592x1944.\nThe first and third are SDR images, while the other two are the corresponding Gainmaps. An XMP data packet, which conforms to the UltraHDR specification and features the Google Container field to identify the existence and size of the Gainmap, can be found in the APP1 segment of each JPEG structure.\nHave you noticed that these resolutions are a bit strange? Gainmaps are generally full resolution or half resolution (half width and height). The Gainmap provided by Hasselblad for the full-resolution SDR image is missing one pixel on the short side, meaning the aspect ratio is not strictly the same, and the Gainmap provided for the lower-resolution SDR image has two-thirds of the original width and height, which is quite unusual.\nIn DPReview‚Äôs review, they wrote:\nThe company says this gives images with up to three additional stops of dynamic range compared to standard sRGB JPEGs, using a technique adopted by Google in its Pixel phones, and by Sigma in its BF Mirrorless camera.\nThis refers to UltraHDR, and the three additional stops of dynamic range likely means the X2D II specifies HDRCapacityMax = 3 in the Gainmap Metadata, providing up to 3 stops of luminance boost via the Gainmap.\nIn addition to the UltraHDR XMP data packet, the JPEG file also contains various data required by the ISO 21496-1 international standard Gain Map HDR format. This makes it not only compliant with the UltraHDR standard but also a future-proof international standard format, and it satisfies the requirements of UltraHDR v1.1.\nRegarding the Gainmap itself, it has only one channel, meaning it is a single-channel Gainmap, which can only handle luminance mapping. This is slightly less advanced compared to the Sigma BF‚Äôs three-channel Gainmap. As for other metadata, it does not use the commonly seen 1/64 Offset but sets it directly to 0, and the Gamma is 1, which are all normal.\nConcurrently, the color space of this JPEG file has changed to Display P3, which is also mentioned on their official website:\nTo fully present the magnificent brilliance of HDR, Hasselblad goes one step further than sRGB, expanding the color space to the broader P3.\nFile Format in Phocus Hasselblad immediately updated its Phocus software for macOS and iOS, adding support for HDR editing and output.\nThe sample images provided on its official website, judging from the file names, appear to be processed and output by Phocus, rather than straight-out JPEGs. Indeed, after exploring the file content, this is confirmed, and they are significantly different from the straight-out JPEGs.\nFirstly, they no longer contain the low-resolution images likely used for in-camera preview. There is only one SDR image and one full-resolution Gainmap. Furthermore, this Gainmap is three-channel, and the Capacity is no longer limited to three stops, reaching four stops or more.\nA more important difference is that this JPEG no longer features the UltraHDR structure. It doesn‚Äôt even have an XMP data packet; it‚Äôs a file with only ISO 21496-1 metadata, using MPF to identify the Gainmap location. From this perspective, the term UltraHDR used on the Phocus output panel is misleading.\nTemporary Note Such a major update in the camera industry is exciting. I wanted to share the parts I‚Äôve already written with everyone. I will add images later and conduct further analysis if I can acquire more sample images.\n",
  "wordCount" : "664",
  "inLanguage": "en",
  "image": "https://img.jackchou.top/jack-img/2025/08/81bb602c03f9704ee42e292468396187.webp","datePublished": "2025-08-26T23:00:00+08:00",
  "dateModified": "2025-09-28T00:57:34+08:00",
  "author":[{
    "@type": "Person",
    "name": "Jack"
  }, {
    "@type": "Person",
    "name": "Tosaki Mk.II"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://jackchou.top/en/posts/x2dii-preview/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "üè°JacksBlog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://jackchou.top/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://jackchou.top/en/" accesskey="h" title="üè°JacksBlog (Alt + H)">üè°JacksBlog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://jackchou.top/" title="‰∏≠Êñá"
                            aria-label="‰∏≠Êñá">‰∏≠Êñá</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://jackchou.top/en/posts/" title="Posts üå≥">
                    <span>Posts üå≥</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/photos/" title="Photos üì∑">
                    <span>Photos üì∑</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/tags/" title="Tags üè∑Ô∏è">
                    <span>Tags üè∑Ô∏è</span>
                </a>
            </li>
            <li>
                <a href="https://jackchou.top/en/about/" title="About üòº">
                    <span>About üòº</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Jumping on the Trend: A Quick Analysis of the X2D II 100C File Format
    </h1>
    
    <div class="post-meta"><span title='2025-08-26 23:00:00 +0800 +0800'>2025.08.26</span>&nbsp;¬∑&nbsp;Jack, Tosaki Mk.II&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="https://jackchou.top/posts/x2dii-preview/">‰∏≠Êñá</a>
    </li>
</ul>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#the-jpeg-file-format-of-hncs-hdr" aria-label="The JPEG File Format of HNCS HDR">The JPEG File Format of HNCS HDR</a></li>
                <li>
                    <a href="#file-format-in-phocus" aria-label="File Format in Phocus">File Format in Phocus</a></li>
                <li>
                    <a href="#temporary-note" aria-label="Temporary Note">Temporary Note</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="the-jpeg-file-format-of-hncs-hdr">The JPEG File Format of HNCS HDR<a hidden class="anchor" aria-hidden="true" href="#the-jpeg-file-format-of-hncs-hdr">#</a></h2>
<p>Let&rsquo;s set aside the specific implementation details of HNCS HDR for a moment and look at how Hasselblad chose the file format to store its HDR output.</p>
<blockquote>
<p>The X2D II 100C is the first medium format camera to support end-to-end HDR capabilities, capable of outputting HDR HEIF or Ultra HDR JPEG photos directly in-camera.</p>
</blockquote>
<p>DPReview released a <a href="https://www.dpreview.com/sample-galleries/4239298554/hasselblad-x2d-ii-100c-sample-gallery">sample gallery</a> for the X2D II immediately, providing in-camera straight-out JPG and RAW downloads. According to Hasselblad, this JPG complies with the UltraHDR standard.</p>
<p>Let&rsquo;s examine the internal details of the file:</p>
<p>The file contains four complete JPEG structures, with resolutions as follows:</p>
<p>11656x8742, 5828x4370, 3888x2918, 2592x1944.</p>
<p>The first and third are SDR images, while the other two are the corresponding Gainmaps. An XMP data packet, which conforms to the UltraHDR specification and features the Google Container field to identify the existence and size of the Gainmap, can be found in the APP1 segment of each JPEG structure.</p>
<p>Have you noticed that these resolutions are a bit strange? Gainmaps are generally full resolution or half resolution (half width and height). The Gainmap provided by Hasselblad for the full-resolution SDR image is missing one pixel on the short side, meaning the aspect ratio is not strictly the same, and the Gainmap provided for the lower-resolution SDR image has two-thirds of the original width and height, which is quite unusual.</p>
<p>In DPReview&rsquo;s <a href="https://www.dpreview.com/reviews/hasselblad-x2d-ii-100c-initial-review">review</a>, they wrote:</p>
<blockquote>
<p>The company says this gives images with up to three additional stops of dynamic range compared to standard sRGB JPEGs, using a technique adopted by Google in its Pixel phones, and by Sigma in its BF Mirrorless camera.</p>
</blockquote>
<p>This refers to UltraHDR, and the three additional stops of dynamic range likely means the X2D II specifies <code>HDRCapacityMax = 3</code> in the Gainmap Metadata, providing up to 3 stops of luminance boost via the Gainmap.</p>
<p>In addition to the UltraHDR XMP data packet, the JPEG file also contains various data required by the ISO 21496-1 international standard Gain Map HDR format. This makes it not only compliant with the UltraHDR standard but also a future-proof international standard format, and it satisfies the requirements of UltraHDR v1.1.</p>
<p>Regarding the Gainmap itself, it has only one channel, meaning it is a single-channel Gainmap, which can only handle luminance mapping. This is slightly less advanced compared to the Sigma BF&rsquo;s three-channel Gainmap. As for other metadata, it does not use the commonly seen 1/64 <code>Offset</code> but sets it directly to 0, and the Gamma is 1, which are all normal.</p>
<p>Concurrently, the color space of this JPEG file has changed to Display P3, which is also mentioned on their official website:</p>
<blockquote>
<p>To fully present the magnificent brilliance of HDR, Hasselblad goes one step further than sRGB, expanding the color space to the broader P3.</p>
</blockquote>
<h2 id="file-format-in-phocus">File Format in Phocus<a hidden class="anchor" aria-hidden="true" href="#file-format-in-phocus">#</a></h2>
<p>Hasselblad immediately updated its Phocus software for macOS and iOS, adding support for HDR editing and output.</p>
<p>The <a href="https://www.hasselblad.com/zh-cn/learn/sample-images/x-system/">sample images provided on its official website</a>, judging from the file names, appear to be processed and output by Phocus, rather than straight-out JPEGs. Indeed, after exploring the file content, this is confirmed, and they are significantly different from the straight-out JPEGs.</p>
<p>Firstly, they no longer contain the low-resolution images likely used for in-camera preview. There is only one SDR image and one full-resolution Gainmap. Furthermore, this Gainmap is three-channel, and the Capacity is no longer limited to three stops, reaching four stops or more.</p>
<p>A more important difference is that this JPEG no longer features the UltraHDR structure. It doesn&rsquo;t even have an XMP data packet; it&rsquo;s a file with only ISO 21496-1 metadata, using MPF to identify the Gainmap location. From this perspective, the term UltraHDR used on the Phocus output panel is misleading.</p>
<p><img alt="Phocus 4.0 Output Section" loading="lazy" src="https://img.jackchou.top/jack-img/2025/08/5a55ddd4c8cc4a6f498c1781b7b6c607.avif"></p>
<h2 id="temporary-note">Temporary Note<a hidden class="anchor" aria-hidden="true" href="#temporary-note">#</a></h2>
<p>Such a major update in the camera industry is exciting. I wanted to share the parts I&rsquo;ve already written with everyone. I will add images later and conduct further analysis if I can acquire more sample images.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://jackchou.top/en/tags/colour/">Colour</a></li>
      <li><a href="https://jackchou.top/en/tags/hdr/">HDR</a></li>
      <li><a href="https://jackchou.top/en/tags/camera/">Camera</a></li>
      <li><a href="https://jackchou.top/en/tags/ultrahdr/">UltraHDR</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://jackchou.top/en/">üè°JacksBlog</a></span> ¬∑ 
        my friends&rsquo; websites: <a href="https://zhxwu.com/">zhxwu.com</a>, <a href="https://ylqian.com/">ylqian.com</a> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a><div style="text-align: center; margin-top: 10px; margin-bottom: 20px; width: 100%; display: flex; justify-content: center;">
    <img src="https://visitor-badge.laobi.icu/badge?page_id=jacksblog" alt="visitors" style="max-width: 120px; height: auto;" />
</div><script>
(() => {
    const images = document.querySelectorAll('.post-content img');
    if (!images.length) return;

    const overlay = document.createElement('div');
    overlay.className = 'image-lightbox';
    overlay.innerHTML = '<img class="image-lightbox__img" alt="" />';

    const overlayImg = overlay.querySelector('img');
    const closeOverlay = () => {
        overlay.classList.remove('is-visible');
        overlayImg.removeAttribute('src');
        document.body.style.removeProperty('overflow');
    };

    overlay.addEventListener('click', closeOverlay);
    document.addEventListener('keyup', (event) => {
        if (event.key === 'Escape' && overlay.classList.contains('is-visible')) {
            closeOverlay();
        }
    });

    document.body.appendChild(overlay);

    images.forEach((img) => {
        img.addEventListener('click', (event) => {
            event.preventDefault();
            event.stopPropagation();

            const source = img.dataset.zoomSrc || img.currentSrc || img.src;
            const cleanSrc = source.split('#')[0];

            overlayImg.src = cleanSrc;
            overlayImg.alt = img.alt || '';

            overlay.classList.add('is-visible');
            document.body.style.setProperty('overflow', 'hidden');
        });
    });
})();
</script>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
